<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multi Address Print</title>

<link href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" rel="stylesheet">

<style>

body {
    font-family: "Segoe UI", sans-serif;
    background: #f4f6f9;
    margin: 0;
    padding: 30px;
}

.container {
    max-width: 1100px;
    margin: auto;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.editor {
    height: 150px;
}

button {
    padding: 10px 25px;
    font-size: 15px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-right: 10px;
}

.add-btn { background: #28a745; color: white; }
.print-btn { background: #007bff; color: white; }

/* ---------------- PRINT LAYOUT ---------------- */

#printArea {
    display: none;
    padding: 10px 20px;
    font-size: 16px; /* Default print font size */
}

.print-block {
    display: flex;
    justify-content: space-between;
    margin-bottom: 25px;
    page-break-inside: avoid;
}

.address-box {
    width: 46%;
    padding: 0px 2px;
    min-height: 130px;
    font-size: 16px;
    line-height: 1.35;
}

/* Label spacing */
#printArea .print-label {
    display: block;
    margin-bottom: 1px;
    font-weight: bold;
}

/* Remove Quill spacing */
#printArea .ql-editor {
    padding: 0;
    margin: 0;
}

#printArea .ql-editor p {
    margin: 0 !important;
    line-height: 1.3;
}

#printArea .ql-editor p:first-child {
    margin-top: 0 !important;
}

/* Quill font size fixes */
.ql-size-small { font-size: 9px; }
.ql-size-large { font-size: 16px; }
.ql-size-huge { font-size: 22px; }

/* ---------------- PRINT VIEW ---------------- */

@media print {

    body * {
        visibility: hidden;
    }

    #printArea, #printArea * {
        visibility: visible;
    }

    #printArea {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
    }

    /* Remove borders in print */
    #printArea .address-box {
        border: none !important;
    }
}

</style>
</head>

<body>

<div class="container">

    <div id="addressContainer"></div>

    <button class="add-btn" onclick="addAddress()">âž• Add More</button>
    <button class="print-btn" onclick="printAll()">ðŸ–¨ Print All</button>

</div>

<div id="printArea"></div>

<script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>

<script>

let addressCount = 0;
let editors = [];

const toolbarOptions = [
    [{ font: [] }],
    [{ size: ['small', false, 'large', 'huge'] }],
    ['bold', 'italic', 'underline'],
    [{ color: [] }, { background: [] }],
    [{ align: [] }],
    [{ list: 'ordered'}, { list: 'bullet' }],
    ['clean']
];

function addAddress() {

    addressCount++;

    const html = `
        <div class="card">
            <h3>Address ${addressCount}</h3>

            <h4>From Address</h4>
            <div id="from_${addressCount}" class="editor"></div>

            <h4>To Address</h4>
            <div id="to_${addressCount}" class="editor"></div>
        </div>
    `;

    document.getElementById("addressContainer")
        .insertAdjacentHTML("beforeend", html);

    const fromEditor = new Quill('#from_' + addressCount, {
        theme: 'snow',
        modules: { toolbar: toolbarOptions }
    });

    const toEditor = new Quill('#to_' + addressCount, {
        theme: 'snow',
        modules: { toolbar: toolbarOptions }
    });

    editors.push({ from: fromEditor, to: toEditor });
}

function cleanHTML(html) {
    return html.replace(/^(<p><br><\/p>)+/, "");
}


function printAll() {

    let printHTML = "";

    editors.forEach((item) => {

        const fromHTML = cleanHTML(item.from.root.innerHTML);
        const toHTML   = cleanHTML(item.to.root.innerHTML);

        printHTML += `
            <div class="print-block">

                <div class="address-box">
                    <span class="print-label">From:</span>
                    <div class="ql-editor">${fromHTML}</div>
                </div>

                <div class="address-box">
                    <span class="print-label">To:</span>
                    <div class="ql-editor">${toHTML}</div>
                </div>

            </div>
        `;
    });

    const printArea = document.getElementById("printArea");
    printArea.innerHTML = printHTML;
    printArea.style.display = "block";

    window.print();

    printArea.style.display = "none";
}

addAddress();

</script>

</body>
</html>
